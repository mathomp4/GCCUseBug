cmake_minimum_required(VERSION 3.20)

# Set the project name
project(FortranProject
    VERSION 1.0
    DESCRIPTION "Project to demonstrate the GCC bug"
    LANGUAGES Fortran)

# Set our compiler flags. We will use debug flags for now
# First for GNU
#set(CMAKE_Fortran_FLAGS_DEBUG "-O0 -g -fcheck=all,no-array-temps -finit-real=snan -save-temps -ffree-line-length-none -fno-range-check -Wno-missing-include-dirs -fbacktrace -Wno-unused-dummy-argument -ffpe-trap=zero,overflow -fbacktrace -fallow-argument-mismatch -fallow-invalid-boz -falign-commons -fPIE -fopenmp")

set_property(GLOBAL PROPERTY RULES_MESSAGES OFF)
set_property(GLOBAL PROPERTY TARGET_MESSAGES OFF)
set_property(GLOBAL PROPERTY RULE_LAUNCH_COMPILE "${CMAKE_COMMAND} -E time")

set(CMAKE_MESSAGE_LOG_LEVEL "WARNING")

set(SOURCES 
  base.F90
{% for n in range(1, num_modules+1) -%}
  module{{n}}.F90
{% endfor %}
)

add_library(test_lib ${SOURCES})
